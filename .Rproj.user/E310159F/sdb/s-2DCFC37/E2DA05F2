{
    "collab_server" : "",
    "contents" : "#' @title\n#' Metadata for Rare Events Search\n#' @description\n#' Function to create db file referenced in rare_events function\n#' @param x eFOQA username in single quotes\n#' @param y eFOQA password in single quotes\n#' @return\n#' Db file (rare_events2.db) saved in the user's working directory\n#' @export\nrare_events_metadata <- function(x, y) {\n\n## Install and load Rems, if not already installed\nif (exists('http_proxy')) {\nlibrary(httr)\nset_config(use_proxy(url=http_proxy, port= proxy_port))\n}\n\nif (!require(devtools)) {\ncat(\"\\n==== Package devtools is not found. Installing devtools\\n\")\ninstall.packages('devtools')\n}\n\nif(!require(Rems)) {\ncat(\"\\n==== Installing Rems\")\ndevtools::install_github(\"ge-flight-analytics/Rems\", dependencies = T)\n}\n\n## Load relevant packages\nlibrary(Rems)\nlibrary(magrittr)\n\n## Connect to EFOQA and assign file name to metadata\nconn <- connect(x, y)\nmetadata <- 'rare_events2.db'\n\n\n##GPWS, Stall Warning\nfq2 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'standard lib', 'p0') %>%\n  set_database('p0: library flight safety events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 0: Event Information') %>%\n  update_fieldtree('Profiles', 'Standard Library Profiles', 'P0: Library Flight Safety Events', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\nfq2 %>%\n  save_metadata()\n\n\n##Not in Takeoff Config\nfq3 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p172: not in t/o config events') %>%\n  set_database('p172: not in t/o config events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 172: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P172: Not in T/O Config', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P172: Not in T/O Config', 'Measured Items', 'Takeoff and Climb', 'Takeoff', 'CUSTOM')\n\nfq3 %>%\n  save_metadata()\n\n\n##High Bank Angle\nfq4 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p186: high bank angle profile events') %>%\n  set_database('p186: high bank angle profile events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 186: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P186: High Bank Angle Profile', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P186: High Bank Angle Profile', 'Measured Items', 'Entire Flight (including taxi)', 'Measurements', 'Flight Dynamics', 'Roll', 'Measurements')\n\nfq4 %>%\n  save_metadata()\n\n\n##Operating Altitude Exceedance\nfq5 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p174: Maximum Operating Altitude Events') %>%\n  set_database('p174: maximum operating altitude events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 174: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P174: Maximum Operating Altitude', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\nfq5 %>%\n  save_metadata()\n\n\n##HSRTO\nfq6 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p196: HSRTO Events') %>%\n  set_database('p196: HSRTO Events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 196: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P196: HSRTO', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\nfq6 %>%\n  save_metadata()\n\n\n##Inadvertent Spoiler Deployment\nfq7 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p176: Inadvertant Spoiler Deployment Events') %>%\n  set_database('p176: Inadvertant Spoiler Deployment Events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 176: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P176: Inadvertant Spoiler Deployment', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P176: Inadvertant Spoiler Deployment', 'Measured Items', 'Takeoff and Climb', 'Takeoff')\n\nfq7 %>%\n  save_metadata()\n\n\n##Parking Brake in Flight\nfq8 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p136: parking brake in flight events') %>%\n  set_database('p136: parking brake in flight events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 136: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P136: Parking Brake in Flight', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\nfq8 %>%\n  save_metadata()\n\n\n##Egregious Unstable Approach\nfq9 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'FOQA', 'Event Validation', 'P198: Unstable Approach Events') %>%\n  set_database('p198: unstable approach events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 198: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'P198: unstable approach', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality') %>%\n  update_fieldtree('Flight Review', 'Duplicate Detection') %>%\n  update_fieldtree('Profiles', 'FOQA', 'Event Validation', 'p198: unstable approach', 'measured items',\n                   'descent and landing', 'roll out', 'measurements', 'flight dynamics', 'vertical speed')\n\nfq9 %>%\n  save_metadata()\n\n\n##Low Level Windshear\nfq10 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p188: low level windshear events') %>%\n  set_database('p188: low level windshear events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 188: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'event validation', 'P188: low level windshear', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\nfq10 %>%\n  save_metadata()\n\n\n##Low Fuel Landings\nfq11 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p197: low fuel landings events') %>%\n  set_database('p197: low fuel landings events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 197: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'event validation', 'P197: low fuel landings', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\nfq11 %>%\n  save_metadata()\n\n\n##Autopilot Disengaged in RVSM\nfq12 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p216: autopilot disengage above rvsm events') %>%\n  set_database('p216: autopilot disengage above rvsm events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 216: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'event validation', 'P216: autopilot disengage above rvsm', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\n\nfq12 %>%\n  save_metadata()\n\n\n##Ground Spoilers\nfq13 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p205: ground spoilers not deployed events') %>%\n  set_database('p205: ground spoilers not deployed events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 205: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'event validation', 'P205: ground spoilers not deployed', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\n\nfq13 %>%\n  save_metadata()\n\n\n##Flap Handle Movement during Takeoff\nfq14 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p203: flap movement on takeoff events') %>%\n  set_database('p203: flap movement on takeoff events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 203: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'event validation', 'P203: flap movement on takeoff', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\n\nfq14 %>%\n  save_metadata()\n\n\n##Low Energy (Airbus)\nfq15 <- flt_query(conn, \"ems4-app\", metadata) %>%\n  update_dbtree('apm events', 'foqa', 'event validation', 'p211: risk of stall (low energy) events') %>%\n  set_database('p211: risk of stall (low energy) events - all events') %>%\n  generate_preset_fieldtree() %>%\n  update_fieldtree('Profile 211: Event Information') %>%\n  update_fieldtree('Profiles', 'FOQA', 'event validation', 'P211: risk of stall (low energy)', 'Processing Status') %>%\n  update_fieldtree('Flight Review', 'Data Quality')\n\n\nfq15 %>%\n  save_metadata()\n\n}\n\n\n\n\n\n\n",
    "created" : 1515168264998.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "254954598",
    "id" : "E2DA05F2",
    "lastKnownWriteTime" : 1515168737,
    "last_content_update" : 1515168737081,
    "path" : "~/GitHub/safetydata/R/rare_events_metadata.R",
    "project_path" : "R/rare_events_metadata.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}